if(window.mitaoApi==undefined){String.prototype.replaceAll=function(e,i,n){if(!RegExp.prototype.isPrototypeOf(e)){return this.replace(new RegExp(e,n?"gi":"g"),i)}else{return this.replace(e,i)}};window.mitaoApi={version:1.1,isIOS:function(){var e=/\((iPhone|iPad|iPod)/i.test(navigator.userAgent)?true:false;return e},isAndroid:function(){return navigator.userAgent.indexOf("Android")!=-1?true:false},isWeChat:function(){return navigator.userAgent.indexOf("MicroMessenger")!=-1?true:false},isFirefox:function(){return navigator.userAgent.indexOf("Firefox")!=-1?true:false},isMitao:function(){return navigator.userAgent.indexOf("mitao")!=-1?true:false},rand:function(e,i){return Math.ceil(random()*number)+e},random:function(){return Math.random()},is_email:function(e){if(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)){return true}return false},isUrl:function(e){var i="^[A-Za-z]+://[A-Za-z0-9-_]+\\.[A-Za-z0-9-_%&?/.=]+$";var n=new RegExp(i);if(n.test(e)){return true}else{return false}},readyFunc:undefined,ready:function(){var e=function(){if(mitaoApi.readyFunc!=undefined&&typeof mitaoApi.readyFunc=="function"){try{mitaoApi.readyFunc()}catch(e){console.error("mitaoApi ready ",e)}}};e()},callfun:{},bridge:null,invoke:function(i,n,t){var r=this;try{var e=function(){};if(t&&t!=undefined&&typeof t=="function"){e=t}window.mitaoApi.callfun[i]=t;if(window.mitaoApi.isIOS()){r.setupWebViewJavascriptBridgeForIos(function(e){r.bridge=e;r.bridge.callHandler(i,JSON.stringify(n),t)})}else{n?window.mitao[i](JSON.stringify(n)):window.mitao[i]()}}catch(e){console.error("mitaoApi call error:",e);alert("发生异常："+e)}},callback:function(i){var e=i.apiName;var n=this;try{if(i){if(mitaoApi.callfun[e]!=undefined){mitaoApi.callfun[e](i)}}else{if(mitaoApi.callfun[e]!=undefined){mitaoApi.callfun[e]()}}}catch(e){console.info("mitaoApi",i)}},setupWebViewJavascriptBridgeForIos:function(e){if(window.WebViewJavascriptBridge){return e(WebViewJavascriptBridge)}if(window.WVJBCallbacks){return window.WVJBCallbacks.push(e)}window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none";i.src="wvjbscheme://__BRIDGE_LOADED__";document.documentElement.appendChild(i);setTimeout(function(){document.documentElement.removeChild(i)},0)},connectWebViewJavascriptBridgeForAndroid:function(e){if(window.WebViewJavascriptBridge){e(WebViewJavascriptBridge)}else{document.addEventListener("WebViewJavascriptBridgeReady",function(){e(WebViewJavascriptBridge)},false)}},loaded:function(e){try{mitaoApi.readyFunc=e}catch(e){console.log("mitaoApi",param)}}}}